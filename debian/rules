#!/usr/bin/make -f

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/autotools.mk
include /usr/share/cdbs/1/rules/patchsys-quilt.mk

DEB_CONFIGURE_EXTRA_FLAGS := --enable-shared
ifeq (m68k,$(shell dpkg-architecture -qDEB_BUILD_ARCH_CPU))
	DEB_CONFIGURE_EXTRA_FLAGS += --disable-foreign
endif

DEB_CONFIGURE_SCRIPT := $(CURDIR)/src/configure
# Optimizations cause build failures on powerpc/alpha, so we'll override the
# standard optimizations and have it hold "-fPIC" instead
DEB_OPT_FLAG := -fPIC

DEB_BUILDDIR := $(DEB_SRCDIR)/build

#DEB_SHLIBDEPS_EXCLUDE_plt-scheme := debian/plt-scheme/plot

binary-post-install/plt-scheme::
	rm -f debian/plt-scheme/usr/lib/plt/collects/profj/classpath/COPYING
	rm -f debian/plt-scheme/usr/lib/plt/collects/profj/classpath/LICENSE
	rmdir debian/plt-scheme/usr/lib/plt/collects/profj/classpath

binary-post-install/plt-scheme-doc::
	# release-notes get installed into plt-scheme
	rm -rf debian/plt-scheme-doc/usr/share/plt/doc/release-notes

cleanbuilddir/plt-scheme::
	rm -rf build
	rm -rf include # This got created at build-time

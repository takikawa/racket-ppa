#!/usr/bin/make -f

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/autotools.mk
include /usr/share/cdbs/1/rules/simple-patchsys.mk

PLTDIR := /usr/lib/plt

DEB_CONFIGURE_EXTRA_FLAGS := --enable-shared
ifeq (hppa,$(shell dpkg-architecture -qDEB_BUILD_ARCH_CPU))
	DEB_CONFIGURE_EXTRA_FLAGS += --disable-foreign
else ifeq (m68k,$(shell dpkg-architecture -qDEB_BUILD_ARCH_CPU))
	DEB_CONFIGURE_EXTRA_FLAGS += --disable-foreign
endif

DEB_CONFIGURE_SCRIPT := $(CURDIR)/src/configure
DEB_CONFIGURE_NORMAL_ARGS := --prefix=/usr --mandir='$${prefix}'/share/man
CFLAGS = -g -Wall -fPIC
CXXFLAGS = -g -Wall -fPIC

DEB_BUILDDIR := $(DEB_SRCDIR)/build
DEB_DESTDIR := $(CURDIR)/debian/drscheme/
DEB_MAKE_INSTALL_TARGET := install prefix=$(DEB_DESTDIR)/usr

DEB_INSTALL_CHANGELOGS_drscheme := --no-act
DEB_INSTALL_DOCS_drscheme := --no-act
DEB_SHLIBDEPS_EXCLUDE_drscheme := debian/drscheme/plot

install/mzscheme::
	dh_movefiles --sourcedir=debian/drscheme -pmzscheme

cleanbuilddir/drscheme::
	rm -rf build
	rm -rf include # This got created at build-time
